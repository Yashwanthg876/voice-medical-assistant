<!DOCTYPE html>
<html>
<head>
  <title>Voice Medical Assistant</title>
</head>
<body>
<h1>Voice to Text</h1>
<button onclick="recordVoice()">ğŸ™ï¸ Record Voice</button>
<p id="result"></p>
<script>
function recordVoice() {
  navigator.mediaDevices.getUserMedia({ audio: true }).then(stream => {
    const mediaRecorder = new MediaRecorder(stream);
    let chunks = [];

    mediaRecorder.start();

    mediaRecorder.ondataavailable = e => chunks.push(e.data);

    setTimeout(() => {
      mediaRecorder.stop();

      mediaRecorder.onstop = () => {
        const blob = new Blob(chunks, { type: "audio/webm" });
        const formData = new FormData();
        formData.append("audio", blob, "voice.webm");

        fetch("/upload_audio", {
          method: "POST",
          body: formData
        })
        .then(response => response.json())
        .then(data => {
          console.log("SERVER RESPONSE:", data);

          document.getElementById("result").innerHTML =
            "<b>You said:</b> " + data.text + "<br>" +
            "<b>Detected intent:</b> " + data.intent;
        });
      };
    }, 4000);
  });
}
</script>
</body>
</html>